<!DOCTYPE HTML>
<html lang="zh-CN">
    <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="renderer" content="webkit">
    <meta name="HandheldFriendly" content="true">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Maverick,熊猫小A,Galileo,blog" />
    <meta name="generator" content="Maverick 1.1" />
    <meta name="template" content="Galileo" />
    <link rel="alternate" type="application/rss+xml" title="智的博客 &raquo; RSS 2.0" href="/feed/index.xml" />
    <link rel="alternate" type="application/atom+xml" title="智的博客 &raquo; ATOM 1.0" href="/feed/atom/index.xml" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/galileo-1c8f2638f2.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/ExSearch/ExSearch-182e5a8868.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/katex.min.css">
    <link href="https://fonts.googleapis.com/css?family=Fira+Code&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700&display=swap">
    <script>
        var ExSearchConfig = {
            root: "",
            api: "https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/bb5fa62b4f89b103e03ee702ead78310.json"
        }
    </script>
    
<title>一些 Typecho 开发笔记 - 智的博客</title>
<meta name="author" content="熊猫小A" />
<meta name="description" content="某些经验性质的东西不写下来很快就会忘，所以有了这一篇备忘。" />
<meta property="og:title" content="一些 Typecho 开发笔记 - 智的博客" />
<meta property="og:description" content="某些经验性质的东西不写下来很快就会忘，所以有了这一篇备忘。" />
<meta property="og:site_name" content="智的博客" />
<meta property="og:type" content="article" />
<meta property="og:url" content="/archives/169/" />
<meta property="og:image" content="" />
<meta property="article:published_time" content="2018-10-18T22:34:00-00.00" />
<meta name="twitter:title" content="一些 Typecho 开发笔记 - 智的博客" />
<meta name="twitter:description" content="某些经验性质的东西不写下来很快就会忘，所以有了这一篇备忘。" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:image" content="" />


    
<meta http-equiv="x-dns-prefetch-control" content="on">
<link rel="dns-prefetch" href="//cdn.jsdelivr.net" />
<link rel="dns-prefetch" href="//blog.imalan.cn" />
<!--
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/brand_font/embed.css" />
<style>.brand{font-family:FZCuJinLFW,serif;font-weight: normal!important;}</style>
-->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<link rel="apple-touch-icon" sizes="180x180" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/apple-touch-icon.png?v=PY43YeeEKx">
<link rel="icon" type="image/png" sizes="32x32" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/favicon-32x32.png?v=yyLyaqbyRG">
<link rel="icon" type="image/png" sizes="16x16" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/favicon-16x16.png?v=yyLyaqbyRG">
<link rel="mask-icon" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/safari-pinned-tab.svg?v=yyLyaqbyRG" color="#505050">
<link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/favicon.ico?v=yyLyaqbyRG">
<meta name="application-name" content="三無計劃">
<meta name="apple-mobile-web-app-title" content="三無計劃">
<meta name="msapplication-TileColor" content="#000000">
<meta name="theme-color" content="#000000">
<meta name="baidu-site-verification" content="9BEwwo6Ibg" />

    </head>
    
    <body>
        
        <div class="container">
            <header id="ga-header">
                <div first>
                    <aside id="ga-brand">
                        <h1 class="brand"><a class="no-style" href="/">智的博客</a></h1>
                        <p>只坚持一种正义。我的正义。</p>
                    </aside>
                </div>
                <div second id="ga-nav">
                    <nav class="navs">
                        <ul><li><a class="ga-highlight" href="/" target="_self">首页</a></li><span class="separator">·</span><li><a class="ga-highlight" href="/archives/" target="_self">归档</a></li><span class="separator">·</span><li><a class="ga-highlight" href="/links/" target="_self">友链</a></li><span class="separator">·</span><li><a class="ga-highlight" href="/about/" target="_self">关于</a></li><span class="separator">·</span><li><a href="#" target="_self" class="search-form-input ga-highlight">搜索</a></li></ul>
                    </nav>
                </div>
            </header>
            <div class="wrapper">
                
<main>    
    <section class="ga-section ga-content">
        <article class="yue">
            <h1 class="ga-post_title">一些 Typecho 开发笔记</h1>
            <span class="ga-post_meta ga-mono">
                <span>熊猫小A</span>
                <time>
                    2018-10-18
                </time>
                
                in <a no-style class="category" href="/category/偶尔Geek/">
                    偶尔Geek
                </a>
                
                
                <span class="leancloud_visitors" 
                    id="/archives/169/" 
                    data-flag-title="一些 Typecho 开发笔记"> · <i class="leancloud-visitors-count"></i> Views</span>
                
            </span>
            <div class="ga-content_body">
                <p>最近做了两个主题，一个是 <a href="https://github.com/AlanDecode/Typecho-Theme-RAW">Typecho-Theme-RAW</a>，另一个就是现在使用的这个，Typecho-Theme-Q。RAW 是我的 Typecho 主题第一作，象征意义比较大一点，主题质量各方面只能算差强人意吧。Q 的起源是因为我觉得 Bootstrap 有点意思，边看文档边写就写出来了，由于有写 RAW 时积累的经验加持，完成得很快。某些经验性质的东西不写下来很快就会忘，所以有了这一篇备忘。</p>
<blockquote><p>以下部分内容来自 <a href="https://qqdie.com">QQ 爹博客</a>等大佬的博文，在此先行感谢。</p>
</blockquote>
<h2>Typecho 配置</h2>
<h3>TYPECHO_DEBUG</h3>
<p>可在 Typecho 根目录下 <code>config.inc.php</code> 中添加以下代码来开启 DEBUG 模式。</p>
<div class="highlight"><pre><span></span><span class="x">define(&#39;__TYPECHO_DEBUG__&#39;, true);</span>
</pre></div>
<p>这个模式下会打印更多的报错信息，某些普通情况直接 500 处理的错误在这里会打印出错误原因与调用堆栈等，很有用。</p>
<h3>TYPECHO_GRAVATR_PREFIX</h3>
<p>这个常量可以修改 GRAVATAR 头像链接的前缀，方便使用国内镜像来加快速度。</p>
<div class="highlight"><pre><span></span><span class="x">define(&#39;__TYPECHO_GRAVATR_PREFIX__&#39;, &#39;https://gravatar.cat.net/avatar&#39;);</span>
</pre></div>
<p>需要注意的是要生效的话需要在主题中使用 Typecho 提供的方法来获取头像链接。</p>
<h3>主题层面修改 Typecho 设置</h3>
<p>在 PJAX 中评论失效的问题需要关闭主题的反垃圾保护，在主题中可以自动做到这一点。在主题目录下 <code>functions.php</code> 中创建如下代码即可。</p>
<div class="highlight"><pre><span></span><span class="x">function themeInit($archive){</span>
<span class="x">    Helper::options()-&gt;commentsAntiSpam = false; </span>
<span class="x">}</span>
</pre></div>
<p>Typecho 系统设置均可使用 <code>Helper::options()</code> 函数获取，权限蛮高的。另：<code>themeInit()</code> 函数完成了主题初始化，创建表之类的操作可以在这个函数中完成。</p>
<h2>主题开发</h2>
<h3>自定义渲染方式</h3>
<p>分别创建 <code>category</code>，<code>page</code>，<code>post</code> 文件夹，在其中创建 <code>分类缩略名.php</code>、<code>页面slug.php</code>、<code>文章cid.php</code> 即可覆盖默认的渲染方式来为某分类、页面、文章创建自定义渲染方式。</p>
<h3>主题设置面板</h3>
<p>在主题根目录下创建 <code>functions.php</code>，在其中定义函数 <code>themeConfig($form)</code></p>
<div class="highlight"><pre><span></span><span class="x">function themeConfig($form) {</span>
<span class="x">    //基本设置</span>
<span class="x">    $notice = new Typecho_Widget_Helper_Form_Element_Textarea(&#39;notice&#39;, NULL, NULL, _t(&#39;网站公告&#39;), _t(&#39;网站公告&#39;));</span>
<span class="x">    $form-&gt;addInput($notice);</span>
<span class="x">    $banner = new Typecho_Widget_Helper_Form_Element_Text(&#39;banner&#39;, NULL, NULL, _t(&#39;网站公告&#39;), _t(&#39;网站公告&#39;));</span>
<span class="x">    $form-&gt;addInput($banner);</span>
<span class="x">}</span>
</pre></div>
<p>类似这样就可以添加 Textarea 或者 Text 类型的输入框。其中的内容在主题中可以通过以下方式来访问。</p>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;options-&gt;ValueName</span>
</pre></div>
<h3>文章自定义字段面板</h3>
<p>在主题根目录下创建 <code>functions.php</code>，在其中定义函数</p>
<div class="highlight"><pre><span></span><span class="x">function themeFields(Typecho_Widget_Helper_Layout $layout) {</span>
<span class="x">    $thumb = new Typecho_Widget_Helper_Form_Element_Textarea(&#39;banner&#39;, NULL, NULL, &#39;文章主图&#39;, &#39;输入图片URL，该图片会用于主页文章列表的显示&#39;);</span>
<span class="x">    $layout-&gt;addItem($thumb);</span>
<span class="x">    $showTOC=new Typecho_Widget_Helper_Form_Element_Select(&#39;showTOC&#39;,array(&#39;0&#39;=&gt;&#39;不显示目录&#39;,&#39;1&#39;=&gt;&#39;显示目录&#39;),&#39;0&#39;,&#39;文章目录&#39;,&#39;是否显示文章目录&#39;);</span>
<span class="x">    $layout-&gt;addItem($showTOC);</span>
<span class="x">}</span>
</pre></div>
<p>与上面相似，这样就可以为自定义字段创建友好的输入方式。这与手动添加自定义字段是等效的，但是可以提高使用体验。</p>
<h3>自定义评论输出方式</h3>
<p>创建 <code>comments.php</code> 文件，require 在 <code>functions.php</code> 中，然后就可以在其中重载输出评论的方式。</p>
<h3>Typecho 内建函数</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;header();</span>
</pre></div>
<p>这个函数要在 <code>head</code> 标签中调用，负责输出 RSS、Pingback 等信息，还涉及输出插件要在 <code>head</code> 中输出的内容。与上面的类似，不过一般在 <code>footer</code> 标签后调用：</p>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;footer();</span>
</pre></div>
<p>获取所有设置：</p>
<div class="highlight"><pre><span></span><span class="x">Helper::options();</span>
</pre></div>
<p>获取某插件设置：</p>

<pre><code>Helper::options()-&gt;plugin($pluginName);</code></pre>
<h2>常用代码片段</h2>
<h3>博客内容统计</h3>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span> <span class="nx">Typecho_Widget</span><span class="o">::</span><span class="na">widget</span><span class="p">(</span><span class="s1">&#39;Widget_Stat&#39;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">to</span><span class="p">(</span><span class="nv">$stat</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">&lt;li&gt;文章总数：</span><span class="cp">&lt;?php</span> <span class="nv">$stat</span><span class="o">-&gt;</span><span class="na">publishedPostsNum</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">篇&lt;/li&gt;</span>
<span class="x">&lt;li&gt;分类总数：</span><span class="cp">&lt;?php</span> <span class="nv">$stat</span><span class="o">-&gt;</span><span class="na">categoriesNum</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">个&lt;/li&gt;</span>
<span class="x">&lt;li&gt;评论总数：</span><span class="cp">&lt;?php</span> <span class="nv">$stat</span><span class="o">-&gt;</span><span class="na">publishedCommentsNum</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">条&lt;/li&gt;</span>
<span class="x">&lt;li&gt;页面总数：</span><span class="cp">&lt;?php</span> <span class="nv">$stat</span><span class="o">-&gt;</span><span class="na">publishedPagesNum</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x">个&lt;/li&gt;</span>
</pre></div>
<h3>输出当前文章为第几篇</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;sequence</span>
</pre></div>
<h3>最近评论</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;widget(&#39;Widget_Comments_Recent&#39;,&#39;ignoreAuthor=true&amp;pageSize=10&#39;)-&gt;to($comments);</span>
<span class="cp">&lt;?php</span> <span class="k">while</span><span class="p">(</span><span class="nv">$comments</span><span class="o">-&gt;</span><span class="na">next</span><span class="p">())</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    </span><span class="cp">&lt;?php</span> <span class="nv">$comments</span><span class="o">-&gt;</span><span class="na">gravatar</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="x">    &lt;a href=&quot;</span><span class="cp">&lt;?php</span> <span class="nv">$comments</span><span class="o">-&gt;</span><span class="na">permalink</span><span class="p">();</span> <span class="cp">?&gt;</span><span class="x">&quot;&gt;</span><span class="cp">&lt;?php</span> <span class="nv">$comments</span><span class="o">-&gt;</span><span class="na">excerpt</span><span class="p">(</span><span class="nv">$num</span><span class="p">,</span> <span class="s1">&#39;...&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x">&lt;/a&gt;</span>
<span class="cp">&lt;?php</span> <span class="k">endwhile</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
<p>其中 <code>ignoreAuthor=true</code> 可以过滤掉博主自己的评论。<code>pageSize</code> 为输出数量。</p>
<h3>Gravatar 头像链接</h3>
<div class="highlight"><pre><span></span><span class="x">Typecho_Common::gravatarUrl($mail, $size, &#39;&#39;, &#39;&#39;, true);</span>
</pre></div>
<p>可以根据邮箱地址给出头像链接。</p>
<h3>输出所有独立页面</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;widget(&#39;Widget_Contents_Page_List&#39;)-&gt;parse(&#39;&lt;li&gt;&lt;a href=&quot;{permalink}&quot; target=&quot;_self&quot;&gt;{title}&lt;/a&gt;&lt;/li&gt;&#39;);</span>
</pre></div>
<p><code>parse</code> 方法可以非常方便地格式化输出所有的独立页面，太帅了。</p>
<h3>文章、评论分页</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;pageNav(&#39;上一页&#39;, &#39;下一页&#39;, 0, &#39;&#39;, &#39;wrapClass=hidden&amp;prevClass=prev&amp;nextClass=next&#39;);</span>
</pre></div>
<h3>判断插件是否可用</h3>
<p>这是一个小坑。只要启用过插件，即使已经禁用了插件，<code>class_exsist()</code> 仍然会返回 <code>true</code>，所以应该如下检验：</p>
<div class="highlight"><pre><span></span><span class="x">/**</span>
<span class="x"> * 判断插件是否存在并启用</span>
<span class="x"> * </span>
<span class="x"> * @return boolean</span>
<span class="x"> */</span>
<span class="x">function isPluginAvailable($name) {</span>
<span class="x">    if (class_exists($name.&#39;_Plugin&#39;)){</span>
<span class="x">        $plugins = Typecho_Plugin::export();</span>
<span class="x">        $plugins = $plugins[&#39;activated&#39;];</span>
<span class="x">        return is_array($plugins) &amp;&amp; array_key_exists($name, $plugins);</span>
<span class="x">    }</span>
<span class="x">    return false;</span>
<span class="x">}</span>
</pre></div>
<h3>校验请求是否来自手机</h3>
<div class="highlight"><pre><span></span><span class="x">/**</span>
<span class="x"> * 手机识别</span>
<span class="x"> * </span>
<span class="x"> * @return boolean</span>
<span class="x"> */</span>
<span class="x">function isPhone(){</span>
<span class="x">    $ua=strtolower($_SERVER[&quot;HTTP_USER_AGENT&quot;]);</span>
<span class="x">    $devices=array(&quot;Android&quot;, &#39;iPhone&#39;, &#39;iPod&#39;, &#39;Phone&#39;);</span>
<span class="x">    foreach ($devices as $device) {</span>
<span class="x">        if(strpos($ua, strtolower($device))){</span>
<span class="x">            return true;</span>
<span class="x">        }</span>
<span class="x">    }</span>
<span class="x">    return false;</span>
<span class="x">}</span>
</pre></div>
<h3>校验请求是否来自移动设备</h3>
<div class="highlight"><pre><span></span><span class="x">/**</span>
<span class="x"> * 移动端判定</span>
<span class="x"> * </span>
<span class="x"> * @return bool</span>
<span class="x"> */</span>
<span class="x">public static function isMobile(){ </span>
<span class="x">    if (isset ($_SERVER[&#39;HTTP_X_WAP_PROFILE&#39;])){</span>
<span class="x">        return TRUE;</span>
<span class="x">    }</span>

<span class="x">    if (isset ($_SERVER[&#39;HTTP_USER_AGENT&#39;])) {</span>
<span class="x">        $clientkeywords = array (&#39;mobile&#39;,&#39;nokia&#39;,&#39;sony&#39;,&#39;ericsson&#39;,&#39;mot&#39;,&#39;samsung&#39;,&#39;htc&#39;,&#39;sgh&#39;,&#39;lg&#39;,&#39;sharp&#39;,&#39;sie-&#39;,&#39;philips&#39;,&#39;panasonic&#39;,&#39;alcatel&#39;,&#39;lenovo&#39;,&#39;iphone&#39;,&#39;ipod&#39;,&#39;blackberry&#39;,&#39;meizu&#39;,&#39;android&#39;,&#39;netfront&#39;,&#39;symbian&#39;,&#39;ucweb&#39;,&#39;windowsce&#39;,&#39;palm&#39;,&#39;operamini&#39;,&#39;operamobi&#39;,&#39;openwave&#39;,&#39;nexusone&#39;,&#39;cldc&#39;,&#39;midp&#39;,&#39;wap&#39;</span>
<span class="x">            ); </span>
<span class="x">        if (preg_match(&quot;/(&quot; . implode(&#39;|&#39;, $clientkeywords) . &quot;)/i&quot;, strtolower($_SERVER[&#39;HTTP_USER_AGENT&#39;]))){</span>
<span class="x">            return TRUE;</span>
<span class="x">        }</span>
<span class="x">    }</span>
<span class="x">    if (isset ($_SERVER[&#39;HTTP_ACCEPT&#39;])){</span>
<span class="x">        if ((strpos($_SERVER[&#39;HTTP_ACCEPT&#39;], &#39;vnd.wap.wml&#39;) !== FALSE) &amp;&amp; (strpos($_SERVER[&#39;HTTP_ACCEPT&#39;], &#39;text/html&#39;) === FALSE || (strpos($_SERVER[&#39;HTTP_ACCEPT&#39;], &#39;vnd.wap.wml&#39;) &lt; strpos($_SERVER[&#39;HTTP_ACCEPT&#39;], &#39;text/html&#39;)))){</span>
<span class="x">            return TRUE;</span>
<span class="x">        }</span>
<span class="x">    }</span>
<span class="x">    return FALSE;</span>
<span class="x">}</span>
</pre></div>
<h3>输出完备的文章标题</h3>
<p>一般是处于 SEO 之用</p>
<div class="highlight"><pre><span></span><span class="x">/**</span>
<span class="x"> * 导出标题</span>
<span class="x"> * </span>
<span class="x"> * @return void</span>
<span class="x"> */</span>
<span class="x">function title(Widget_Archive $archive){</span>
<span class="x">    $archive-&gt;archiveTitle(array(</span>
<span class="x">        &#39;category&#39;  =&gt;  _t(&#39;分类 %s 下的文章&#39;),</span>
<span class="x">        &#39;search&#39;    =&gt;  _t(&#39;包含关键字 %s 的文章&#39;),</span>
<span class="x">        &#39;tag&#39;       =&gt;  _t(&#39;标签 %s 下的文章&#39;),</span>
<span class="x">        &#39;author&#39;    =&gt;  _t(&#39;%s 发布的文章&#39;)</span>
<span class="x">    ), &#39;&#39;, &#39; - &#39;);</span>
<span class="x">    Helper::options()-&gt;title();</span>
<span class="x">}</span>
</pre></div>
<h3>面包屑导航</h3>
<p>用以输出当前位置相对主页的路由。</p>
<div class="highlight"><pre><span></span><span class="cp">&lt;?php</span> <span class="k">if</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">))</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x">&lt;!-- 页面为首页时 --&gt;</span>
<span class="x">    文章列表 &amp;raquo; 第&amp;nbsp;</span><span class="cp">&lt;?php</span> <span class="k">echo</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">_currentPage</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x">&amp;nbsp;页</span>
<span class="cp">&lt;?php</span> <span class="k">elseif</span> <span class="p">(</span><span class="nv">$this</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;post&#39;</span><span class="p">))</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x">&lt;!-- 页面为文章单页时 --&gt;</span>
<span class="x">    文章 &amp;raquo; </span><span class="cp">&lt;?php</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">title</span><span class="p">()</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="cp">&lt;?php</span> <span class="k">else</span><span class="o">:</span> <span class="cp">?&gt;</span><span class="x">&lt;!-- 页面为其他页时 --&gt;</span>
<span class="cp">&lt;?php</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">archiveTitle</span><span class="p">(</span><span class="k">array</span><span class="p">(</span>
    <span class="s1">&#39;category&#39;</span>  <span class="o">=&gt;</span>  <span class="nx">_t</span><span class="p">(</span><span class="s1">&#39;分类 &quot;%s&quot; 下的文章&#39;</span><span class="p">),</span>
    <span class="s1">&#39;search&#39;</span>    <span class="o">=&gt;</span>  <span class="nx">_t</span><span class="p">(</span><span class="s1">&#39;包含关键字 &quot;%s&quot; 的文章&#39;</span><span class="p">),</span>
    <span class="s1">&#39;tag&#39;</span>       <span class="o">=&gt;</span>  <span class="nx">_t</span><span class="p">(</span><span class="s1">&#39;标签 &quot;%s&quot; 下的文章&#39;</span><span class="p">),</span>
    <span class="s1">&#39;author&#39;</span>    <span class="o">=&gt;</span>  <span class="nx">_t</span><span class="p">(</span><span class="s1">&#39;%s 发布的文章&#39;</span><span class="p">)</span>
<span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span> <span class="cp">?&gt;</span><span class="x"></span>
<span class="cp">&lt;?php</span> <span class="k">endif</span><span class="p">;</span> <span class="cp">?&gt;</span><span class="x"></span>
</pre></div>
<h3>某些可以简化工作量的函数</h3>
<div class="highlight"><pre><span></span><span class="x">$this-&gt;options-&gt;themeUrl(&#39;/some/path/&#39;); //输出相对主题目录的路径</span>
<span class="x">Helper::options()-&gt;pluginUrl; //获取插件目录</span>
<span class="x">Helper::options()-&gt;index(&#39;/some/path/&#39;); //输出相对博客根目录的路径</span>
</pre></div>
<h2>数据库相关</h2>
<h3>根据 CID 调用文章</h3>
<div class="highlight"><pre><span></span><span class="x">$db = Typecho_Db::get();</span>
<span class="x">$row = $db-&gt;fetchRow($db-&gt;select()-&gt;from(&#39;table.contents&#39;)-&gt;where(&#39;cid = ?&#39;, $cid));</span>
</pre></div>
<p><code>$row</code> 为 Array，包括了文章本题的许多字段，包括 <code>title</code>、创建日期等。</p>
<h3>获得某文章的某自定义字段</h3>
<div class="highlight"><pre><span></span><span class="x">$row = $db-&gt;fetchAll($db-&gt;select()-&gt;from(&#39;table.fields&#39;)-&gt;where(&#39;cid = ?&#39;, $cid)-&gt;where(&#39;name = ?&#39;, $fieldName));</span>
<span class="x">$field=$row[0][&#39;str_value&#39;];</span>
</pre></div>
<p>数据库相关属于比较高级的用法了，虽然在某些时候不得不用，但是最好还是使用 Typecho 提供的更原生的方法。更多：<a href="https://qqdie.com/archives/typecho-database-api.html">Typecho数据库常用API</a> 。</p>
<p>暂时就这些，后续想到再添加。</p>

            </div>
        </article>
        <div id="ga-tags">
    
</div>
    </section>

    
<section id="ga-content_pager">

    <div class="next">
        <a class="ga-highlight" href="/archives/171/">让炮姐跟着我跑 - 缓动跟随 Demo</a>
        <p class="yue">果然还是想看超炮啊</p>
    </div>


    <div class="prev">
        <a class="ga-highlight" href="/archives/168/">Typecho-Plugin-DoubanBoard 发布</a>
        <p class="yue">在博客上展示你的豆瓣书单、豆瓣影单 & MORE！</p>
    </div>

</section>


    
        <script>
            var initValine = function () {
                new Valine({"enable": true, "el": "#vcomments", "appId": "6chFXPTjrjYnjFk9duROcboN-gzGzoHsz", "appKey": "c1CRooaFmpLs4xi7x3YLm3ma", "visitor": true, "recordIP": true, "placeholder": "\u6765\u7545\u6240\u6b32\u8a00\u5427~"});
            }
        </script>
        <script defer src='https://cdn.jsdelivr.net/npm/valine@1.3.10/dist/Valine.min.js' onload="initValine()"></script>
        <div id="vcomments"></div>
    

</main>

                <footer class="ga-mono" id="ga-footer">
                    <section>
                        <span id="ga-uptime"></span>
                        <span class="brand">智的博客</span>
                    </section>
                    <section>
                        <p class="copyright">
                            <span>Copyright © 2020 熊猫小A</span>
                            <span>Powered by <a no-style href="https://github.com/AlanDecode/Maverick" target="_blank">Maverick & Galileo</a></span>
                        </p>
                        <div class="copyright">
                            <span class="footer-addon">
                                
<a no-style href="http://beian.miit.gov.cn" target="_blank">京ICP备18000133号-1</a> | 
<a no-style href="https://www.upyun.com" target="_blank">又拍云</a>

                            </span>
                            <nav class="social-links">
                                <ul><li><a class="no-style" title="Twitter" href="https://twitter.com/AlanDecode" target="_blank"><i class="gi gi-twitter"></i>Twitter</a></li><span class="separator">·</span><li><a class="no-style" title="GitHub" href="https://github.com/AlanDecode" target="_blank"><i class="gi gi-github"></i>GitHub</a></li><span class="separator">·</span><li><a class="no-style" title="Weibo" href="https://weibo.com/5245109677/" target="_blank"><i class="gi gi-weibo"></i>Weibo</a></li></ul>
                            </nav>
                        </div>
                    </section>
                    <script>
                        var site_build_date = "2017-06-29T12:00+08:00"
                    </script>
                    <script src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/galileo-dc4baa7cf4.js"></script>
                </footer>
            </div>
        </div>
    </div>

    <!--katex-->
    <script defer src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/katex.min.js"></script>
    <script>
    mathOpts = {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "\\[", right: "\\]", display: true},
            {left: "$", right: "$", display: false},
            {left: "\\(", right: "\\)", display: false}
        ]
    };
    </script>
    <script defer src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/auto-render.min.js" onload="renderMathInElement(document.body, mathOpts);"></script>

    <script src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/ExSearch/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/AlanDecode/site-Blog@gh-pages/assets/ExSearch/ExSearch-493cb9cd89.js"></script>

    
<script>
    var _hmt = _hmt || [];
    (function() {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?e4f3a7c02ac2aabc41a1cfa95f61a026";
    var s = document.getElementsByTagName("script")[0]; 
    s.parentNode.insertBefore(hm, s);
    })();
</script>
<script>
    (function(){
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        }
        else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
<script>
if(window.location.hash){
    var checkExist = setInterval(function() {
       if ($(window.location.hash).length) {
          $('html, body').animate({scrollTop: $(window.location.hash).offset().top-90}, 1000);
          clearInterval(checkExist);
       }
    }, 100);
}
</script>
<script>
if(window.navigator && navigator.serviceWorker) {
  caches.keys().then(function(cacheNames) {
    cacheNames.forEach(function(cacheName) {
      caches.delete(cacheName);
    });
  }).then(function(){
    console.log('Cache cleaned.');
  });
  navigator.serviceWorker.getRegistrations()
  .then(function(registrations) {
    for(let registration of registrations) {
      registration.unregister();
    }
  }).then(function(){
    console.log('Service Worker stopped.');
  });
}
</script>

    </body>
</html>